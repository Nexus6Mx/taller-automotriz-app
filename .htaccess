# Activa el motor de reescritura de URL de Apache
RewriteEngine On

# ----------------------------------------------------------------------
# REGLA CLAVE PARA SOLUCIONAR EL ERROR DE CORS Y REDIRECCIÓN
# ----------------------------------------------------------------------
# Esta regla detiene el procesamiento de cualquier petición de tipo OPTIONS.
# Esto permite que nuestro script 'cors.php' maneje la respuesta
# en lugar de que el servidor intente redirigirla.
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [L]
# ----------------------------------------------------------------------

# Redirigir todo el tráfico de HTTP a HTTPS para seguridad (DESACTIVADO PARA DESARROLLO LOCAL)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Pasa el encabezado de autorización a PHP para la autenticación
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

# Protege archivos sensibles para que no se puedan acceder desde el navegador
<FilesMatch "database.php">
    Order allow,deny
    Deny from all
</FilesMatch>

# Evita que la gente pueda listar el contenido de las carpetas
Options -Indexes